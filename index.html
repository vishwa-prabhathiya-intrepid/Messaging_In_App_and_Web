<!DOCTYPE html>
<html>
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, minimum-scale=1"
  />
  <head>
    <title>External Live Agent</title>
  </head>

  <body>
    <h1>Hello World</h1>
    <p>I'm hosted with GitHub Pages.</p>

    <iframe id="myIframe" src="https://intrepidgroup--vishwamsg.sandbox.my.site.com/newagency/survey/runtimeApp?invitationId=0Ki9p00000081tN&surveyName=sample_survey&UUID=6831949a-c657-4be1-909c-27d7a5254e40"></iframe>

    <script type="text/javascript">
      document.getElementById("myIframe").width = window.innerWidth + "px";
      document.getElementById("myIframe").height = window.innerHeight + "px";

      function initEmbeddedMessaging() {
        try {
          embeddedservice_bootstrap.settings.language = "en_US"; // For example, enter 'en' or 'en-US'

          //embeddedservice_bootstrap.settings.chatButtonPosition = "95%,5%";
            window.addEventListener("onEmbeddedMessagingReady", e => {
            let referringSite = "http://chart.apis.google.com/chart?chs=500x500&chma=0,0,100,100&cht=p&chco=FF0000%2CFFFF00%7CFF8000%2C00FF00%7C00FF00%2C0000FF&chd=t%3A122%2C42%2C17%2C10%2C8%2C7%2C7%2C7%2C7%2C6%2C6%2C6%2C6%2C5%2C5&chl=122%7C42%7C17%7C10%";
            if (referringSite.length > 200) {
              referringSite = referringSite.substring(0, 200);
            }
            embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields({"Referring_Site" : referringSite});
          });

          

          embeddedservice_bootstrap.init(
          '00D9p000009UmQ6',
          'Vishwa_Channel',
          'https://intrepidgroup--vishwamsg.sandbox.my.site.com/ESWVishwaChannel1762496597135',
            {
              scrt2URL: 'https://intrepidgroup--vishwamsg.sandbox.my.salesforce-scrt.com'
            }
          );
        } catch (err) {
          console.error("Error loading Embedded Messaging: ", err);
        }
      }
      //window.addEventListener("onEmbeddedMessagingReady", e => {
        //console.log('its running...')
        //embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields({"Referring_Site" : window.location.href});
      //});
    </script>
    <script type='text/javascript' src='https://intrepidgroup--vishwamsg.sandbox.my.site.com/ESWVishwaChannel1762496597135/assets/js/bootstrap.min.js' onload='initEmbeddedMessaging()'></script>
  </body>
</html>
